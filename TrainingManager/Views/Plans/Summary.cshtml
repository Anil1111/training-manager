@model TrainingManager.ViewModels.PlansFormViewModel
@{
    ViewBag.Title = "Plan Summary";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section styles {
    <link href="~/Content/star-rating.min.css" media="all" rel="stylesheet" type="text/css" />
}

@section Scripts {
    <script src="~/Scripts/bootbox.min.js"></script>
    <script src="~/Scripts/angular.min.js"></script>
    <script src="~/js/app-plans.js"></script>
    <script src="~/js/plansController.js"></script>
    <script src="~/Scripts/star-rating.js" type="text/javascript"></script>
}

<h2 class="text-center">@Model.Name Summary</h2>
<hr style="margin-bottom: 10px;" />
<div ng-app="app-plans" ng-controller="plansController as vm" ng-init="init(@Model.PlanId, @Model.LengthInWeeks)" ng-cloak>
    <div class="row text-center">
        <div class="alert alert-success" role="alert" ng-hide="!vm.generalMessage" ng-cloak>
            <strong>Success!</strong> {{ vm.generalMessage }} &nbsp;
        </div>

        <div class="alert alert-danger" role="alert" ng-hide="!vm.errorMessage" ng-cloak>
            <strong>Oh snap!</strong> {{ vm.errorMessage }}
        </div>

        <input class="js-star-rating rating-loading" value="@Model.Rating" data-size="xs" />
        @if (Model.RatingCount > 0 && Model.RatingCount != 1)
        {
            <p class="text-muted" style="font-size: 12px;">Based on @Model.RatingCount user ratings</p>
        }
        @if (Model.RatingCount == 1)
        {
            <p class="text-muted" style="font-size: 12px;">Based on @Model.RatingCount user rating</p>
        }
        <p>Created on: @Model.CreatedOn</p>
        @if (Model.Favourites == 1)
        {
            <p>Favourited by @Model.Favourites user</p>
        }
        else
        {
            <p>Favourited by @Model.Favourites users</p>
        }
        <p>Views: @Model.Views</p>
    </div>
    <hr />

    <h3 class="text-center" style="margin-bottom:20px;">Week {{model.currWeek}}</h3>

    <div class="row">
        <div class="col-md-1 text-center" style="padding: 0">
            <div style="background-color:white; margin:0px; border: solid 1px #dddddd; border-right:none; height: 211.5px;">
                <i ng-show="model.showWeekLeft" class="glyphicon glyphicon-chevron-left summaryShiftArrow" ng-click="shiftWeekLeft();" style="font-size: 2em; padding-top: 88px; padding-bottom: 88px; width:100%;"></i>
            </div>
        </div>
        <div class="col-md-10" style="padding:0">
            <table class="table table-bordered" style="table-layout: fixed;">
                <tr style="color:white; background-color:black;">
                    <th style="border: solid 1px #dddddd;" class="text-center">Monday</th>
                    <th style="border: solid 1px #dddddd;" class="text-center">Tuesday</th>
                    <th style="border: solid 1px #dddddd;" class="text-center">Wednesday</th>
                    <th style="border: solid 1px #dddddd;" class="text-center">Thursday</th>
                    <th style="border: solid 1px #dddddd;" class="text-center">Friday</th>
                    <th style="border: solid 1px #dddddd;" class="text-center">Saturday</th>
                    <th style="border: solid 1px #dddddd;" class="text-center">Sunday</th>
                </tr>
                <tr>
                    <td style="padding:0px; border: solid 1px #dddddd;" ng-repeat="i in model.days">
                        @if (User.Identity.IsAuthenticated)
                        {
                            <div ng-show="model.workoutsDict[((model.currWeek-1)*7)+i]">
                                <a class="btn" type="button" href="#" ng-href="@Url.Action("Summary", "Workouts")?planId=@Model.PlanId&workoutId={{model.workoutsDict[((model.currWeek-1)*7)+i].Id}}" style="border-radius: 0px; padding-top: 50px; padding-bottom: 50px; font-size: 12px; width:100%; background-color: #f2f2f2; color: black">
                                    {{ model.workoutsDict[((model.currWeek-1)*7)+i].Name }}
                                </a>
                                <div>
                                    <a type="button" href="#" ng-href="@Url.Action("Edit", "Workouts")?planId=@Model.PlanId&workoutId={{model.workoutsDict[((model.currWeek-1)*7)+i].Id}}" class="btn btn-info" style="width: 100%; float:left; height:26px; border-radius:0px; font-size: 10px;">Edit</a>
                                    <button ng-click="removeWorkout(model.workoutsDict[((model.currWeek-1)*7)+i].Id)" class="btn btn-danger" style="width: 100%; float:left; height: 26px; border-radius:0px; font-size: 10px;">Remove</button>
                                </div>
                            </div>
                            <div class="text-center">
                                <a ng-show="!model.workoutsDict[((model.currWeek-1)*7)+i]" type="button" class="btn" href="@Url.Action("Create", "Workouts")?planId=@Model.PlanId&week={{model.currWeek-1}}&day={{i}}" style="margin-top: 60px; margin-bottom: 60px; font-size:26px; color:#5cb85c; border-radius: 0px; width: 100%;">
                                    +
                                </a>
                            </div>
                        }
                        else
                        {
                            <div ng-show="model.workoutsDict[((model.currWeek-1)*7)+i]">
                                <a class="btn" type="button" href="#" ng-href="@Url.Action("Summary", "Workouts")?planId=@Model.PlanId&workoutId={{model.workoutsDict[((model.currWeek-1)*7)+i].Id}}" style="border-radius: 0px; padding-top: 76px; padding-bottom: 76px; font-size: 12px; width:100%; background-color: #f2f2f2; color: black;">
                                    {{ model.workoutsDict[((model.currWeek-1)*7)+i].Name }}
                                </a>
                            </div>
                            <div ng-show="!model.workoutsDict[((model.currWeek-1)*7)+i]" style="height:169px;"></div>
                        }
                    </td>
                </tr>
            </table>
        </div>
        <div class="col-md-1 text-center" style="padding: 0">
            <div style="background-color:white; margin:0px; border: solid 1px #dddddd; border-left:none; height: 211.5px;">
                <i ng-show="model.showWeekRight" class="glyphicon glyphicon-chevron-right summaryShiftArrow" ng-click="shiftWeekRight();" style="font-size: 2em; padding-top: 88px; padding-bottom: 88px; border-radius: 0px; width:100%;"></i>
            </div>
        </div>
    </div>
</div>